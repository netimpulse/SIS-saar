{% comment %}
  ** Custom Icon Carousel Section **
  - V5: Correct pointed shape with clip-path, double size, 3-item view.
{% endcomment %}

{{ 'custom-icon-carousel.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .section-{{ section.id }} .custom-icon-carousel-wrapper {
    --pointer-color: {{ section.settings.pointer_color }};
    --arrow-color: {{ section.settings.arrow_color }};
    --border-color-active: {{ section.settings.border_color }};
    --wrapper-bg: {{ section.settings.wrapper_bg_color }};
  }
  .section-{{ section.id }} .custom-icon-carousel-section { 
    --section-color:{{ section.settingssection_bg_color }}
  }
 
{%- endstyle -%}

<div class="section-{{ section.id }} custom-icon-carousel-section"
     data-section-id="{{ section.id }}">
  <div class="page-width">
    <div class="custom-icon-carousel-wrapper">
      {%- if section.blocks.size > 1 -%}
        <button type="button" class="carousel-arrow carousel-arrow--prev" aria-label="Previous slide">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
        </button>
      {%- endif -%}
      
      <div class="carousel-viewport">
        <div class="carousel-track">
          {%- for block in section.blocks -%}
            <div class="carousel-slide" {{ block.shopify_attributes }}>
              <a href="{{ block.settings.link | default: '#' }}" class="slide-link">
                <div class="slide-icon">
                  {%- if block.settings.icon_image != blank -%}
                    <img src="{{ block.settings.icon_image | image_url: width: 180 }}"
                         alt="{{ block.settings.icon_image.alt | escape }}"
                         loading="lazy"
                         width="90"
                         height="90">
                  {%- else -%}
                    <div class="icon-placeholder">
                       <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg>
                    </div>
                  {%- endif -%}
                </div>
                <div class="slide-title">
                  <p>{{ block.settings.title | escape }}</p>
                </div>
              </a>
            </div>
          {%- endfor -%}
        </div>
      </div>

      {%- if section.blocks.size > 1 -%}
        <button type="button" class="carousel-arrow carousel-arrow--next" aria-label="Next slide">
           <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/></svg>
        </button>
      {%- endif -%}
    </div>
  </div>
</div>

<script src="{{ 'custom-icon-carousel.js' | asset_url }}" defer="defer"></script>


{% schema %}
{
  "name": "Icon Carousel",
  "tag": "section",
  "class": "custom-icon-carousel-section-wrapper",
  "max_blocks": 12,
  "settings": [
    {
      "type": "header",
      "content": "Color Settings"
    },
    {
      "type": "color",
      "id": "arrow_color",
      "label": "Arrow Color",
      "default": "#FF6600"
    },
    {
      "type": "color",
      "id": "pointer_color",
      "label": "Active Pointer Color",
      "default": "#FF6600"
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Active Border Color",
      "default": "#E0E0E0"
    },
    {"type": "color",
  "id": "section_bg_color",
  "label": "Section Background Color",
  "default": "#F9F9F9"
     }
     
  ],
  "blocks": [
    {
      "type": "icon_block",
      "name": "Icon Block",
      "settings": [
        {
          "type": "image_picker",
          "id": "icon_image",
          "label": "Icon Image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Your Title"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Icon Carousel",
      "blocks": [
        { "type": "icon_block" },
        { "type": "icon_block" },
        { "type": "icon_block" },
        { "type": "icon_block" },
        { "type": "icon_block" }
      ]
    }
  ]
}
{% endschema %}
