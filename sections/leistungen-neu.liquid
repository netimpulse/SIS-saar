{% comment %}
  ** Leistungen Neu Sektion **
  - Design basierend auf dem Screenshot
  - Unendliches Karussell
  - Vollständig anpassbar im Editor
{% endcomment %}

{{ 'leistungen-neu.css' | asset_url | stylesheet_tag }}

{%- style -%}
  .section-{{ section.id }}.leistungen-neu-section {
    background-color: {{ section.settings.section_bg_color }};
    /* NEU: Padding-Regler für die Höhe des Blocks */
    padding-top: {{ section.settings.padding_top }}px;
    padding-bottom: {{ section.settings.padding_bottom }}px;
  }
  .section-{{ section.id }} .leistungen-neu-container {
    max-width: 100%; /* Container füllt nun die Sektion */
  }
  .section-{{ section.id }} .leistungen-neu-heading {
    color: {{ section.settings.heading_color }};
    font-size: {{ section.settings.heading_font_size }}px;
    font-family: {{ section.settings.heading_font.family }}, {{ section.settings.heading_font.fallback_families }};
    font-style: {{ section.settings.heading_font.style }};
    font-weight: {{ section.settings.heading_font.weight }};
  }
  .section-{{ section.id }} .carousel-arrow {
    color: {{ section.settings.arrow_color }};
  }
  .section-{{ section.id }} .service-item__timeline-connector {
    background-color: {{ section.settings.line_color }};
  }

  {% for block in section.blocks %}
    .section-{{ section.id }} .service-item-{{ block.id }} .service-item__image-wrapper {
      --image-diameter: {{ block.settings.image_diameter }}px;
    }
    .section-{{ section.id }} .service-item-{{ block.id }} .service-item__title {
      font-size: {{ block.settings.title_font_size }}px;
      color: {{ block.settings.title_color }};
      font-family: {{ block.settings.title_font.family }}, {{ block.settings.title_font.fallback_families }};
      font-style: {{ block.settings.title_font.style }};
      font-weight: {{ block.settings.title_font.weight }};
    }
    .section-{{ section.id }} .service-item-{{ block.id }} .service-item__subtitle {
      font-size: {{ block.settings.subtitle_font_size }}px;
      color: {{ block.settings.subtitle_color }};
      font-family: {{ block.settings.subtitle_font.family }}, {{ block.settings.subtitle_font.fallback_families }};
      font-style: {{ block.settings.subtitle_font.style }};
      font-weight: {{ block.settings.subtitle_font.weight }};
    }
    .section-{{ section.id }} .service-item-{{ block.id }} .service-item__text,
    .section-{{ section.id }} .service-item-{{ block.id }} .service-item__text p {
      font-size: {{ block.settings.text_font_size }}px;
      color: {{ block.settings.text_color }};
      font-family: {{ block.settings.text_font.family }}, {{ block.settings.text_font.fallback_families }};
      font-style: {{ block.settings.text_font.style }};
      font-weight: {{ block.settings.text_font.weight }};
    }
  {% endfor %}
{%- endstyle -%}

<div class="section-{{ section.id }} leistungen-neu-section" data-section-id="{{ section.id }}">
  <div class="page-width">
    <div class="leistungen-neu-container">

      {%- if section.settings.heading != blank -%}
        <h2 class="leistungen-neu-heading">{{ section.settings.heading | escape }}</h2>
      {%- endif -%}

      <div class="carousel-wrapper">
        <div class="carousel-viewport">
          <div class="carousel-track">
            {%- for block in section.blocks -%}
              <div class="carousel-slide" {{ block.shopify_attributes }}>
                <div class="service-item service-item-{{ block.id }}">
                  <div class="service-item__timeline">
                    <div class="service-item__image-wrapper">
                      {%- if block.settings.main_image != blank -%}
                        <img class="service-item__main-image" src="{{ block.settings.main_image | image_url: width: 300 }}" alt="{{ block.settings.main_image.alt | escape }}" loading="lazy">
                      {%- else -%}
                         {{ 'image' | placeholder_svg_tag: 'service-item__main-image placeholder' }}
                      {%- endif -%}

                      {%- if block.settings.number_icon != blank -%}
                         <img class="service-item__number-icon" src="{{ block.settings.number_icon | image_url: width: 80 }}" alt="{{ block.settings.number_icon.alt | escape }}" loading="lazy">
                      {%- endif -%}
                    </div>
                  </div>

                  <div class="service-item__content">
                    {%- if block.settings.title != blank -%}
                      <h3 class="service-item__title">{{ block.settings.title }}</h3>
                    {%- endif -%}
                    {%- if block.settings.subtitle != blank -%}
                      <h4 class="service-item__subtitle">{{ block.settings.subtitle }}</h4>
                    {%- endif -%}
                    {%- if block.settings.text != blank -%}
                      <div class="service-item__text">{{ block.settings.text }}</div>
                    {%- endif -%}
                  </div>
                </div>
              </div>
            {%- endfor -%}
          </div>
          <div class="service-item__timeline-connector"></div>
        </div>

        {%- if section.blocks.size > 1 -%}
          <button type="button" class="carousel-arrow carousel-arrow--prev" aria-label="Vorherige Leistung">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
          </button>
          <button type="button" class="carousel-arrow carousel-arrow--next" aria-label="Nächste Leistung">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/></svg>
          </button>
        {%- endif -%}
      </div>
    </div>
  </div>
</div>

<script src="{{ 'leistungen-neu.js' | asset_url }}" defer="defer"></script>

{% schema %}
{
  "name": "Leistungen Neu",
  "tag": "section",
  "class": "leistungen-neu-wrapper",
  "max_blocks": 15,
  "settings": [
    {
      "type": "header",
      "content": "Allgemeine Einstellungen"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Überschrift",
      "default": "Unsere Leistungen"
    },
    {
      "type": "font_picker",
      "id": "heading_font",
      "label": "Schriftart der Überschrift",
      "default": "sans-serif"
    },
    {
      "type": "range",
      "id": "heading_font_size",
      "min": 20, "max": 80, "step": 1, "unit": "px",
      "label": "Schriftgröße der Überschrift",
      "default": 42
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Farbe der Überschrift",
      "default": "#333333"
    },
    {
      "type": "header",
      "content": "Abstände & Farben"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0, "max": 200, "step": 5, "unit": "px",
      "label": "Innenabstand Oben",
      "default": 50
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0, "max": 200, "step": 5, "unit": "px",
      "label": "Innenabstand Unten",
      "default": 50
    },
    {
      "type": "color",
      "id": "section_bg_color",
      "label": "Hintergrundfarbe",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "arrow_color",
      "label": "Pfeilfarbe",
      "default": "#111111"
    },
    {
      "type": "color",
      "id": "line_color",
      "label": "Farbe der Verbindungslinie",
      "default": "#DDDDDD"
    }
  ],
  "blocks": [
    {
      "type": "service_block",
      "name": "Leistung",
      "settings": [
        {
          "type": "header", "content": "Bilder"
        },
        {
          "type": "image_picker", "id": "main_image", "label": "Hauptbild (rund)"
        },
        {
          "type": "image_picker", "id": "number_icon", "label": "Icon-Bild (z.B. Nummer)"
        },
        {
          "type": "range", "id": "image_diameter", "min": 80, "max": 200, "step": 5, "unit": "px", "label": "Größe des Hauptbildes", "default": 150
        },
        {
          "type": "header", "content": "Texte"
        },
        {
          "type": "text", "id": "title", "label": "Titel", "default": "Industrieservice"
        },
        {
          "type": "text", "id": "subtitle", "label": "Untertitel", "default": "Gebäudeservice"
        },
        {
          "type": "richtext", "id": "text", "label": "Beschreibungstext", "default": "<p>Listenpunkt 1<br>Listenpunkt 2</p>"
        },
        {
          "type": "header", "content": "Text-Styling: Titel"
        },
        {
          "type": "font_picker", "id": "title_font", "label": "Schriftart", "default": "sans-serif"
        },
        {
          "type": "range", "id": "title_font_size", "min": 12, "max": 40, "step": 1, "unit": "px", "label": "Schriftgröße", "default": 20
        },
        {
          "type": "color", "id": "title_color", "label": "Farbe", "default": "#000000"
        },
        {
          "type": "header", "content": "Text-Styling: Untertitel"
        },
        {
          "type": "font_picker", "id": "subtitle_font", "label": "Schriftart", "default": "sans-serif"
        },
        {
          "type": "range", "id": "subtitle_font_size", "min": 10, "max": 30, "step": 1, "unit": "px", "label": "Schriftgröße", "default": 16
        },
        {
          "type": "color", "id": "subtitle_color", "label": "Farbe", "default": "#555555"
        },
        {
          "type": "header", "content": "Text-Styling: Beschreibung"
        },
        {
          "type": "font_picker", "id": "text_font", "label": "Schriftart", "default": "sans-serif"
        },
        {
          "type": "range", "id": "text_font_size", "min": 10, "max": 24, "step": 1, "unit": "px", "label": "Schriftgröße", "default": 14
        },
        {
          "type": "color", "id": "text_color", "label": "Farbe", "default": "#333333"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Leistungen Neu",
      "blocks": [
        { "type": "service_block" },
        { "type": "service_block" },
        { "type": "service_block" },
        { "type": "service_block" },
        { "type": "service_block" }
      ]
    }
  ]
}
{% endschema %}
